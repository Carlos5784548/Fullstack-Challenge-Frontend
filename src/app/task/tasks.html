<div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 gap-4">
  <h2 class="text-2xl font-bold text-gray-800">Tus tareas</h2>
  <button (click)="logout()"
    class="bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg shadow-sm transition">
    Cerrar sesión
  </button>
</div>

<form [formGroup]="taskForm" (ngSubmit)="submit()" class="grid gap-4 mb-8 bg-white p-6 rounded-lg shadow-md">
  <input formControlName="titulo" placeholder="Título" required
    class="border border-gray-300 rounded-md px-4 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500" />

  <textarea formControlName="descripcion" placeholder="Descripción"
    class="border border-gray-300 rounded-md px-4 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500"></textarea>

  <input type="fechaLimite" formControlName="fechaLimite"
    class="border border-gray-300 rounded-md px-4 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500" />

  <select formControlName="estado"
    class="border border-gray-300 rounded-md px-4 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500">
    <option value="pendiente">Pendiente</option>
    <option value="en progreso">En progreso</option>
    <option value="completada">Completada</option>
  </select>

  <div class="flex gap-3 flex-wrap">
    <button type="submit"
      class="bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-md transition shadow">
      {{ editingTask ? 'Actualizar' : 'Crear' }}
    </button>
    <button *ngIf="editingTask" type="button" (click)="cancelEdit()"
      class="bg-gray-400 hover:bg-gray-500 text-white px-4 py-2 rounded-md transition shadow">
      Cancelar
    </button>
  </div>
</form>

<ul class="space-y-4">
  <li *ngFor="let task of tasks"
    class="bg-white rounded-lg shadow p-4 flex flex-col sm:flex-row sm:justify-between sm:items-center gap-3 hover:shadow-md transition">
    <div class="flex-1">
      <h3 class="font-semibold text-lg text-gray-800 flex items-center gap-2">
        📝 {{ task.titulo }}
      </h3>
      <p class="text-sm text-gray-600">{{ task.descripcion }}</p>
      <p class="text-xs text-gray-400 mt-1">📅 Fecha límite: {{ task.fechaLimite || 'Sin fecha' }}</p>
      <p class="text-xs mt-1">
        📌 Estado:
        <span [ngClass]="{
          'text-yellow-600 font-semibold': task.estado === 'pendiente',
          'text-blue-600 font-semibold': task.estado === 'en progreso',
          'text-green-600 font-semibold': task.estado === 'completada'
        }">
          {{ task.estado }}
        </span>
      </p>
    </div>
    <div class="flex gap-2 justify-end">
      <button (click)="edit(task)"
        class="text-indigo-600 hover:underline text-sm font-medium">Editar</button>
      <button (click)="delete(task.id!)"
        class="text-red-600 hover:underline text-sm font-medium">Borrar</button>
    </div>
  </li>
</ul>
